<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>Qrant | 考研戰士Tim</title><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><script type="module">import Chatbot from "https://cdn.jsdelivr.net/npm/flowise-embed/dist/web.js"
Chatbot.init({
    chatflowid: "160d8cb2-a65d-4c81-8016-40ded49c61e1",
    apiHost: "https://flowise-production-c284.up.railway.app",
})</script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="考研戰士Tim" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/plugins/highlight/atom-one-dark.min.css"><script type="text/javascript" src="/plugins/highlight/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();
</script><script type="text/javascript" src="/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">TIM</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">考研戰士Tim</a></h1></div><p class="m-desc"><img width = 80px height = 80px src ='https://timtimtimtimtim.pythonanywhere.com/static/qr.png'/></p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/categories/">專案</a></li><li><span class="dot">●</span><a href="/certificate/">證書</a></li><li><span class="dot">●</span><a href="/about/">關於</a></li><li><span class="dot">●</span><a href="/archives/">歷程</a></li><li><span class="dot">●</span><a href="/timchat/">timchat</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="搜索" onfocus="if(this.value=='搜索'){this.value='';}" onblur="if(this.value==''){this.value='搜索';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">Qrant</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2024/04/01/Qrant/">2024-04-01</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/AI/">AI</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><h1 id="Qdrant-向量資料庫"><a href="#Qdrant-向量資料庫" class="headerlink" title="Qdrant 向量資料庫"></a>Qdrant 向量資料庫</h1><h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><p>儲存切分後的文字及向量供可反覆查詢</p>
<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull qdrant/qdrant</span><br></pre></td></tr></table></figure>

<h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -p 6333:6333 \</span><br><span class="line">    -v $(pwd)/path/to/data:/qdrant/storage \</span><br><span class="line">    qdrant/qdrant</span><br></pre></td></tr></table></figure>
<h3 id="run-costume-config"><a href="#run-costume-config" class="headerlink" title="run costume config"></a>run costume config</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -p 6333:6333 \</span><br><span class="line">    -v $(pwd)/path/to/data:/qdrant/storage \</span><br><span class="line">    -v $(pwd)/path/to/custom_config.yaml:/qdrant/config/custom_config.yaml \</span><br><span class="line">    qdrant/qdrant \</span><br><span class="line">    ./qdrant --config-path config/custom_config.yaml</span><br></pre></td></tr></table></figure>

<h2 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker compose"></a>Docker compose</h2><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">qdrant:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">qdrant/qdrant:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">qdrant</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6333</span><span class="string">:6333</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6334</span><span class="string">:6334</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6333</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6334</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6335</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source:</span> <span class="string">qdrant_config</span></span><br><span class="line">        <span class="attr">target:</span> <span class="string">/qdrant/config/production.yaml</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./qdrant_data:/qdrant_data</span></span><br><span class="line"></span><br><span class="line"><span class="attr">configs:</span></span><br><span class="line">  <span class="attr">qdrant_config:</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">|</span></span><br><span class="line">      <span class="attr">log_level:</span> <span class="string">INFO</span>        </span><br></pre></td></tr></table></figure>

<h3 id="local-build"><a href="#local-build" class="headerlink" title="local build"></a>local build</h3><p>可以在<code>/config/qdrant</code>中的 <code>config.ymal</code>中找到</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">api_key:</span> <span class="string">your_secret_api_key_here</span></span><br></pre></td></tr></table></figure>

<p>之後build 一個自己的image</p>
<h3 id="use-default"><a href="#use-default" class="headerlink" title="use default"></a>use default</h3><p>如果要使用default image 來做更改，也可以</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -p 6333:6333 \</span><br><span class="line">    -v $(pwd)/path/to/data:/qdrant/storage \</span><br><span class="line">    -v $(pwd)/path/to/custom_config.yaml:/qdrant/config/production.yaml \</span><br><span class="line">    qdrant/qdrant</span><br></pre></td></tr></table></figure>

<h3 id="run-1"><a href="#run-1" class="headerlink" title="run"></a>run</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<h2 id="Sql-使用"><a href="#Sql-使用" class="headerlink" title="Sql 使用"></a>Sql 使用</h2><h3 id="創建collection"><a href="#創建collection" class="headerlink" title="創建collection"></a>創建collection</h3><p>1536 是 openai embedding 的維度</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -X PUT http://localhost:6333/collections/rd \</span><br><span class="line">  -H &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">  --data-raw &#x27;&#123;</span><br><span class="line">    &quot;vectors&quot;: &#123;</span><br><span class="line">      &quot;size&quot;: 1536,</span><br><span class="line">      &quot;distance&quot;: &quot;Cosine&quot;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="創建包含-apikey-的collection"><a href="#創建包含-apikey-的collection" class="headerlink" title="創建包含 apikey 的collection"></a>創建包含 apikey 的collection</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X PUT http://localhost:6333/collections/eip   -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -H <span class="string">&#x27;Authorization: Bearer api-key&#x27;</span>   --data-raw <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;vectors&quot;: &#123;</span></span><br><span class="line"><span class="string">      &quot;size&quot;: 1536,</span></span><br><span class="line"><span class="string">      &quot;distance&quot;: &quot;Cosine&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure>


<h3 id="看資訊"><a href="#看資訊" class="headerlink" title="看資訊"></a>看資訊</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -X GET http://localhost:6333/collections/your-collection-name</span><br></pre></td></tr></table></figure>

<h3 id="移除Collection"><a href="#移除Collection" class="headerlink" title="移除Collection"></a>移除Collection</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -X DELETE http://localhost:6333/collections/your-collection-name</span><br></pre></td></tr></table></figure>

<h1 id="qdrant介面操作-link"><a href="#qdrant介面操作-link" class="headerlink" title="qdrant介面操作#link"></a>qdrant介面操作#<a target="_blank" rel="noopener" href="http://ai.zerozero.com.tw:6333/dashboard">link</a></h1><img src="/2024/04/01/Qrant/1.png" class="" title="qdrant介面">

<h2 id="1-左邊欄位點console輸入以下程式碼"><a href="#1-左邊欄位點console輸入以下程式碼" class="headerlink" title="1.左邊欄位點console輸入以下程式碼"></a>1.左邊欄位點console輸入以下程式碼</h2><img src="/2024/04/01/Qrant/2.png" class="" title="操作">
<h3 id="qdrant增刪查語法"><a href="#qdrant增刪查語法" class="headerlink" title="qdrant增刪查語法"></a>qdrant增刪查語法</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> collections<span class="operator">/</span>ec</span><br><span class="line"></span><br><span class="line">PUT collections<span class="operator">/</span>ec</span><br><span class="line">&#123;</span><br><span class="line">   &quot;vectors&quot;: &#123;</span><br><span class="line">      &quot;size&quot;: <span class="number">1536</span>,</span><br><span class="line">      &quot;distance&quot;: &quot;Cosine&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GET</span> collections<span class="operator">/</span>ec</span><br></pre></td></tr></table></figure>
<ul>
<li>DELETE 刪除ec向量集</li>
<li>PUT  創建 1536是向量維度</li>
<li>GET  查詢</li>
</ul>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">本文作者：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">TIM</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">本文連接：</span><span class="p-copytight-value"><a href="/2024/04/01/Qrant/">https://Timtimtimchen.github.io/2024/04/01/Qrant/</a></span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/vector/">vector</a></span></div><aside id="toc"><div class="toc-title">目录</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Qdrant-%E5%90%91%E9%87%8F%E8%B3%87%E6%96%99%E5%BA%AB"><span class="toc-number">1.</span> <span class="toc-text">Qdrant 向量資料庫</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E9%80%94"><span class="toc-number">1.1.</span> <span class="toc-text">用途</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker"><span class="toc-number">1.2.</span> <span class="toc-text">Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pull"><span class="toc-number">1.2.1.</span> <span class="toc-text">pull</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run"><span class="toc-number">1.2.2.</span> <span class="toc-text">run</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run-costume-config"><span class="toc-number">1.2.3.</span> <span class="toc-text">run costume config</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-compose"><span class="toc-number">1.3.</span> <span class="toc-text">Docker compose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#config"><span class="toc-number">1.3.1.</span> <span class="toc-text">config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#local-build"><span class="toc-number">1.3.2.</span> <span class="toc-text">local build</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#use-default"><span class="toc-number">1.3.3.</span> <span class="toc-text">use default</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run-1"><span class="toc-number">1.3.4.</span> <span class="toc-text">run</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sql-%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">Sql 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%B5%E5%BB%BAcollection"><span class="toc-number">1.4.1.</span> <span class="toc-text">創建collection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%B5%E5%BB%BA%E5%8C%85%E5%90%AB-apikey-%E7%9A%84collection"><span class="toc-number">1.4.2.</span> <span class="toc-text">創建包含 apikey 的collection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E8%B3%87%E8%A8%8A"><span class="toc-number">1.4.3.</span> <span class="toc-text">看資訊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4Collection"><span class="toc-number">1.4.4.</span> <span class="toc-text">移除Collection</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qdrant%E4%BB%8B%E9%9D%A2%E6%93%8D%E4%BD%9C-link"><span class="toc-number">2.</span> <span class="toc-text">qdrant介面操作#link</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%B7%A6%E9%82%8A%E6%AC%84%E4%BD%8D%E9%BB%9Econsole%E8%BC%B8%E5%85%A5%E4%BB%A5%E4%B8%8B%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="toc-number">2.1.</span> <span class="toc-text">1.左邊欄位點console輸入以下程式碼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#qdrant%E5%A2%9E%E5%88%AA%E6%9F%A5%E8%AA%9E%E6%B3%95"><span class="toc-number">2.1.1.</span> <span class="toc-text">qdrant增刪查語法</span></a></li></ol></li></ol></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/2024/04/01/llama-index/">&lt; llama-index</a><a class="next" href="/2024/04/01/Flowise/">Flowise &gt;</a></div></section><footer><p><strong>Tim's blog</strong> © 2016 - 2024 <a href="/." rel="nofollow">考研戰士Tim</a> | <img src="https://timtimtimtimtim.pythonanywhere.com/static/unnamed.jpg" width="50px" height="50px"></p></footer></div></div></div><script type="text/javascript" src="/js/search.js"></script><script type="text/javascript" src="/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script></body></html>